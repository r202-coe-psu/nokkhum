__BRYTHON__.use_VFS = true;
var scripts = {"$timestamp": 1598935535127, "processors.status": [".py", "from browser import ajax,document,window,timer,html,bind\nimport javascript\n\n\nclass ProcessorStatus:\n def __init__(self,url,icon_size=\"large\"):\n  self.icon_size=icon_size\n  self.get_state_url=url\n  \n def disable_button(self,docs,cam_id):\n  for doc in docs:\n   if doc.id ==cam_id:\n    doc.disabled=True\n    \n def enable_button(self,docs,cam_id):\n  for doc in docs:\n   if doc.id ==cam_id:\n    doc.disabled=False\n    \n @bind(\"button.stoplpr\",\"click\")\n def stop_lpr(ev):\n \n  camera_id,project_id=(ev.target.id).split(\"/\")\n  ajax.post(f\"/cameras/{camera_id}/stoplpr\",data={\"project_id\":project_id})\n  \n @bind(\"button.startlpr\",\"click\")\n def start_lpr(ev):\n \n  camera_id,project_id=(ev.target.id).split(\"/\")\n  ajax.post(f\"/cameras/{camera_id}/startlpr\",data={\"project_id\":project_id})\n  \n def update_state(self,req_data):\n  for data in req_data:\n   print(data)\n   \n   data_id=data[\"camera_id\"]+\"/\"+data[\"project_id\"]\n   i=html.I()\n   color=\"grey\"\n   if data[\"state\"]in [\"running\",\"start\"]:\n    color=\"green\"\n    s=html.SPAN(style={\"color\":\"green\"})\n    self.disable_button(document.select(\".startlpr\"),data_id)\n    self.enable_button(document.select(\".stoplpr\"),data_id)\n   elif data[\"state\"]in [\"starting\"]:\n    color=\"yellow\"\n    s=html.SPAN(style={\"color\":\"yellow\"})\n    self.disable_button(document.select(\".stoplpr\"),data_id)\n    self.enable_button(document.select(\".startlpr\"),data_id)\n   elif data[\"state\"]in [\"stop\"]:\n    color=\"grey\"\n    s=html.SPAN(style={\"color\":\"grey\"})\n    self.disable_button(document.select(\".stoplpr\"),data_id)\n    self.enable_button(document.select(\".startlpr\"),data_id)\n   elif data[\"state\"]in [\"stopping\"]:\n    color=\"red\"\n    s=html.SPAN(style={\"color\":\"red\"})\n    self.disable_button(document.select(\".stoplpr\"),data_id)\n    self.enable_button(document.select(\".startlpr\"),data_id)\n    \n   i.class_name=f\"ui {color} circle icon {self.icon_size}\"\n   try :\n    document[f\"state-{data['camera_id']}\"].text=\"\"\n    document[f\"state-{data['camera_id']}\"]<=i+s\n   except Exception:\n    continue\n    \n def on_ajax_complete(self,request):\n  request_data=javascript.JSON.parse(request.text)\n  \n  self.update_state(request_data)\n  \n def get_all_camera_state(self):\n  ajax.get(\n  f\"{self.get_state_url}\",oncomplete=self.on_ajax_complete,\n  )\n  \n def start(self):\n  self.get_all_camera_state()\n  timer.set_interval(self.get_all_camera_state,5000)\n", ["browser", "javascript"]], "processors": [".py", "from . import status\n\n__all__=[\"status\"]\n", ["processors", "processors.status"], 1]}
__BRYTHON__.update_VFS(scripts)
