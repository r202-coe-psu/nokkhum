{% extends '/storages/index.html' %}
{% import '/base/html-renderer.html' as renderer %}
{% block title %}Video Storage: {{camera.name}}{% endblock %}

{% block dashboard_title %}
<h2>
  <a href="{{ url_for('projects.view', project_id=camera.project.id) }}">
    {{ camera.project.name | title }}
  </a>
  >
  <a href="{{ url_for('cameras.view', camera_id=camera.id, project_id=camera.project.id) }}">
    {{camera.name}}
  </a>
  >
  <a href="{{ url_for('storages.list_storage_by_processor', processor_id=processor.id) }}">
    Storage
  </a>
  >
  {{camera.name}}
</h2>
{% endblock %}


{% block content %}

<div class="ui vertical segment">
  <div class="ui stackable five column grid">
    {% if file_list | length == 0%}
    <p style="padding-top: 1rem; padding-bottom: 1rem;"><span class="ui medium grey text">Don't have any video file in
        this
        Directory.
      </span>
    </p>
    {% endif %}
    {% for f in file_list %}
    {%- if f.name.startswith('_') %}
    {% set image_style = ' disabled' %}
    {% else %}
    {% set image_style = '' %}
    {%- endif %}
    <div class="column">
      <div class="ui card">
        <div class="ui medium image{{ image_style }}">
          {%- if f.name.startswith('_') %}
          <img
            src="{{ url_for('storages.get_thumbnail', processor_id=processor.id, date_dir=date_dir, filename='{}-thumbnail.png'.format(f.stem[1:])) }}">
          {% else %}
          <a
            href="{{ url_for('storages.view_video', processor_id=processor.id, date_dir=date_dir, filename=f.name.split('.')[0]) }}">
            <img
              src="{{ url_for('storages.get_thumbnail', processor_id=processor.id, date_dir=date_dir, filename='{}-thumbnail.png'.format(f.stem.split('.')[0])) }} ">
          </a>
          {%- endif %}
        </div>
        {% set name = f.name[f.name.find('-')+1: f.name.rfind('-')] %}
        <div class="content">
          {%- if not f.name.startswith('_') %}
          <a
            href="{{ url_for('storages.view_video', processor_id=processor.id, date_dir=date_dir, filename=f.name.split('.')[0]) }}">
            <i class="file video icon"></i>
            {{ name }}
          </a>
          {% else %}
          <div class="header">{{ name }}</div>
          <div class="description">Recording</div>
          {%- endif %}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

{% endblock %}